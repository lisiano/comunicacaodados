<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Técnicas de canais de radiofrequência </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
    <!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
    <!--script src="js/less-1.3.3.min.js"></script-->
    <!--append ‘#!watch’ to the browser URL, then refresh the page. -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <![endif]-->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/scripts.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=visualization"></script>
    <script>
    var map;
    idm = 1;
    markeredicaoatual = 0;
    markeredicaoatualm = 0;
    function initialize() {
    var mapOptions = {
    zoom: 15,
    center: new google.maps.LatLng(-29.6825737,-51.4591107)
    };
    map = new google.maps.Map(document.getElementById('map-canvas'),
    mapOptions);
    }
    google.maps.event.addDomListener(window, 'load', initialize);
    $(document).ready(function(){
    $("#btneditar").click(function(){
      markeredicaoatual.set("frequencia", $("#txtfrequencia").val());
      markeredicaoatual.set("bs", $("#txtalturabs").val());
      markeredicaoatual.set("ms", $("#txtalturams").val());
      markeredicaoatual.set("local", $("#txtlocal").val());
      markeredicaoatual.set("raio", $("#txtraio").val());
    markeredicaoatual.set("modelo", $("#modelo").val());
    markeredicaoatual.set("local", $("#local").val());
    if(markeredicaoatual.modelo == "0")
    {
      scalateste = OkumuraHata(markeredicaoatual);
    }
    else
    {
    scalateste = cost231(markeredicaoatual);
    }
    markeredicaoatual.set("icon", {
    path: google.maps.SymbolPath.CIRCLE,
    fillOpacity: 0,
    fillColor: '#ff0000',
    strokeOpacity: 0,
    strokeColor: '#fff000',
    strokeWeight: 3.0,
    scale: scalateste.tamanho //pixels
    });
      
    var marker2 = new google.maps.Marker({
    position: markeredicaoatual.getPosition(),
    draggable:true,
    map: map,
    });
    marker2.set("icon", {
    path: google.maps.SymbolPath.CIRCLE,
    fillOpacity: 0,
    fillColor: '#000',
    strokeOpacity: 1.0,
    strokeColor: '#000',
    strokeWeight: 4.0,
    scale: scalateste.mobile //pixels
    });
    map.setCenter(marker2.getPosition())
    markeredicaoatualm = marker2;
    var taxiData = [markeredicaoatual.getPosition()];
    var pointArray = new google.maps.MVCArray(taxiData);
    heatmap = new google.maps.visualization.HeatmapLayer({
    data: pointArray
    });
    
    heatmap.set('gradient', heatmap.get('gradient') ? null : markeredicaoatual.gradient);
    heatmap.set('radius', heatmap.get('radius') ? null : scalateste.tamanho);
    heatmap.setMap(map);
    });
      $("#btnadd").click(function(){
        
    if(markeredicaoatual != 0)
    {
    markeredicaoatual.setMap(null);
    markeredicaoatualm.setMap(null);
    }
    var myLatlng = new google.maps.LatLng(-29.6825737,-51.4591107);
    var mapOptions = {
    zoom: 4,
    center: myLatlng
    }
    var marker = new google.maps.Marker({
    position: myLatlng,
    draggable:true,
    map: map,
    });
    marker.set("posicao","-");
    marker.set("frequencia","-");
    marker.set("bs", "-");
    marker.set("ms", "-");
    marker.set("local", "-");
    marker.set("raio", "-");
    marker.set("id", idm);
    idm++;
    google.maps.event.addListener(marker, 'click', function() {
    
    var val = marker.get("id");
    markeredicaoatual = marker;
      pegavalores();
    });
    
    map.setCenter(marker.getPosition())
      });
    });


    function pegavalores()
    {
      markeredicaoatual.title = "teste";
      $("#txtposicao").val(markeredicaoatual.getPosition());
      $("#txtfrequencia").val(markeredicaoatual.frequencia);
      $("#txtalturabs").val(markeredicaoatual.bs);
      $("#txtalturams").val(markeredicaoatual.ms);
      $("#txtlocal").val(markeredicaoatual.local);
      $("#txtraio").val(markeredicaoatual.raio);
    $("#modelo").val(markeredicaoatual.modelo);
    $("#local").val(markeredicaoatual.local);
    }
    

    function cost231(markeredicaoatual)
    {
    var gradient = [
    'rgba(0, 255, 255, 0)',
    'rgba(0, 255, 255, 1)',
    'rgba(0, 191, 255, 1)',
    'rgba(0, 127, 255, 1)',
    'rgba(0, 63, 255, 1)',
    'rgba(0, 0, 255, 1)',
    'rgba(0, 0, 223, 1)',
    'rgba(0, 0, 191, 1)',
    'rgba(0, 0, 159, 1)',
    'rgba(0, 0, 127, 1)',
    'rgba(63, 0, 91, 1)',
    'rgba(127, 0, 63, 1)',
    'rgba(191, 0, 31, 1)',
    'rgba(255, 0, 0, 1)'
    ];
    var aretorno = {
    tamanho:20,
    mobile:10,
    gradient:gradient
    };
    /*
    Lp=69.55+26.16*Math.log10(fc)-13.82*Math.log10(hb)-a(hm,fc)+(44.9-6.55*Math.log10(hb))*Math.log10(d);
    return Lp;
    Lps=Lp-2*(Math.log10(fc/28))^2-5.4;
    Lpo=Lp-4.78*(Math.log10(fc))^2-18.33*Math.log10(fc)-40.98;
    E=69.82-6.16*Math.log10(fc)+13.82*Math.log10(hb)+a(hm,fc)-(44.9-6.55*Math.log10(hb))*Math.log10(d^b);
    */
    return aretorno;
    }

    function OkumuraHata(markeredicaoatual)
    {
    
    var gradient = [
    'rgba(0, 255, 255, 0)',
    'rgba(0, 255, 255, 1)',
    'rgba(0, 191, 255, 1)',
    'rgba(0, 127, 255, 1)',
    'rgba(0, 63, 255, 1)',
    'rgba(0, 0, 255, 1)',
    'rgba(0, 0, 223, 1)',
    'rgba(0, 0, 191, 1)',
    'rgba(0, 0, 159, 1)',
    'rgba(0, 0, 127, 1)',
    'rgba(63, 0, 91, 1)',
    'rgba(127, 0, 63, 1)',
    'rgba(191, 0, 31, 1)',
    'rgba(255, 0, 0, 1)'
    ];
    var aretorno = {
    tamanho:150,
    mobile:70,
    gradient:gradient
    };
    /*
    Lp=69.55+26.16*Math.log10(fc)-13.82*Math.log10(hb)-a(hm,fc)+(44.9-6.55*Math.log10(hb))*Math.log10(d);
    return Lp;
    Lps=Lp-2*(Math.log10(fc/28))^2-5.4;
    Lpo=Lp-4.78*(Math.log10(fc))^2-18.33*Math.log10(fc)-40.98;
    E=69.82-6.16*Math.log10(fc)+13.82*Math.log10(hb)+a(hm,fc)-(44.9-6.55*Math.log10(hb))*Math.log10(d^b);
    */
    return aretorno;
    }

    function a(a,b)
    {return 1;}


    </script>
  </head>
  <body>
    <div class="container">
      <div class="row clearfix">
        <div class="col-md-12 column">
          <h3>
          Técnicas de canais de radiofrequência
          </h3> <button type="button" id="btnadd" class="btn btn-default">Adicionar pontos</button>
          <div class="row clearfix">
            <div class="col-md-8 column" style="height:600px;" id="map-canvas">
            </div>
            <div class="col-md-4 column">
              <h3>
              Propriedades
              </h3>
              <form role="form">
                <div class="form-group">
                  <label for="exampleInputEmail1">Posição<input type="text" readonly="readonly" class="form-control" id="txtposicao" />
                  
                  <label for="exampleInputEmail1">Frequência<input type="text" class="form-control" id="txtfrequencia" />
                  
                  <label for="exampleInputEmail1">Altura da antena BS<input type="text" class="form-control" id="txtalturabs" />
                  
                  <label for="exampleInputEmail1">Altura da antena MS<input type="text" class="form-control" id="txtalturams" />
                  
                  <label for="exampleInputEmail1">Local<input type="text" class="form-control" id="txtlocal" />
                  <label for="exampleInputEmail1">Modelo<br><select id="modelo"><option value="0">Okumura Hata</option><option value="1">Cost-231 Hata</option></select>
                  
                  <label for="exampleInputEmail1">Local<br><select id="local"><option value="0">Urbano</option><option value="1">Suburbano</option value="2"><option>Rural</option></select>
                  <label for="exampleInputEmail1">Raio<input type="text" class="form-control" id="txtraio" />
                  <button type="button" id="btneditar" class="btn btn-default">Atualizar</button>
                  <p>Ajuda: Adicione o ponto, selecione o ponto, modifique as propriedades e clique em atualizar!</p>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </body>
  </html>